# 主牡馬スコア
import os
import inspect

import model.conf.KJraConst as const


def upsert(accessor, ss):

	try:
		template = """
			select 
				count(*) 
			from 
				{0}
			where	
				stud_id ='{1}' 
			"""
		cmd = template.format(
			const.TBL_KJDB_STUD_SCORE,
			ss['stud_id']
			)
		accessor.execute(cmd)

		count =0
		for c in accessor.cur.fetchall():
			count = int(c[0])
			break	  
		if 0 ==  count:  
			template = """
					insert into {0} 
					( 
						stud_id,
						09T1823,
						07D2330,
						07T1418,
						05T1418,
						06T1418,
						99D1418,
						06D2330,
						99T1418,
						08T1823,
						02T2330,
						02D2330,
						10D1418,
						09T0714,
						03D1418,
						99T1823,
						10T30OV,
						05T1823,
						09D0714,
						09T2330,
						01D0714,
						10D2330,
						05D1418,
						05D1823,
						10D0714,
						03T2330,
						08D0714,
						06T2330,
						03T1418,
						99T0714,
						08T0714,
						05T0714,
						99T30OV,
						02T1823,
						01T1823,
						07T0714,
						02T0714,
						09D1418,
						06T30OV,
						08T2330,
						09D1823,
						99D2330,
						10T2330,
						06T1823,
						09T1418,
						03T0714,
						03D2330,
						06D0714,
						99D0714,
						07D1418,
						03D0714,
						07T2330,
						99D30OV,
						04D2330,
						07T30OV,
						06T0714,
						08D1823,
						04T30OV,
						06D1418,
						07D0714,
						01D2330,
						02D1418,
						04D1418,
						01T1418,
						03T1823,
						08D1418,
						01D1418,
						04T1823,
						10T1418,
						01T2330,
						05D0714,
						07T1823,
						04T2330,
						99D1823,
						02D0714,
						10T0714,
						04D0714,
						08T30OV,
						99D0000,
						04T1418,
						02T1418,
						03T30OV,
						08T1418,
						07D1823,
						99T2330,
						99T0000,
						04T0714,
						09T30OV,
						01T0714,
						10T1823,
						05T30OV,
						05T2330,
						05D2330


					) values (
						'{1}',  {2} , {3} ,   {4} ,  {5} ,  {6} ,  {7} ,  {8} ,  {9} , {10} ,
						{11} , {12} , {13} , {14} , {15} , {16} , {17} , {18} , {19} , {20} ,
						{21} , {22} , {23} , {24} , {25} , {26} , {27} , {28} , {29} , {30} ,
						{31} , {32} , {33} , {34} , {35} , {36} , {37} , {38} , {39} , {40} ,
						{41} , {42} , {43} , {44} , {45} , {46} , {47} , {48} , {49} , {50} ,
						{51} , {52} , {53} , {54} , {55} , {56} , {57} , {58} , {59} , {60} ,
						{61} , {62} , {63} , {24} , {65} , {66} , {67} , {68} , {69} , {60} ,
						{71} , {72} , {73} , {24} , {75} , {76} , {77} , {78} , {79} , {80} ,
						{81} , {82} , {83} , {24} , {85} , {86} , {87} , {88} , {89} , {90} ,
						{91} , {92} , {93}
					)
					"""
		else:
			template = """
					update {0} 
					set					
						09T1823={2},
						07D2330={3},
						07T1418={4},
						05T1418={5},
						06T1418={6},
						99D1418={7},
						06D2330={8},
						99T1418={9},
						08T1823={10},
						02T2330={11},
						02D2330={12},
						10D1418={13},
						09T0714={14},
						03D1418={15},
						99T1823={16},
						10T30OV={17},
						05T1823={18},
						09D0714={19},
						09T2330={20},
						01D0714={21},
						10D2330={22},
						05D1418={23},
						05D1823={24},
						10D0714={25},
						03T2330={26},
						08D0714={27},
						06T2330={28},
						03T1418={29},
						99T0714={30},
						08T0714={31},
						05T0714={32},
						99T30OV={33},
						02T1823={34},
						01T1823={35},
						07T0714={36},
						02T0714={37},
						09D1418={38},
						06T30OV={39},
						08T2330={40},
						09D1823={41},
						99D2330={42},
						10T2330={43},
						06T1823={44},
						09T1418={45},
						03T0714={46},
						03D2330={47},
						06D0714={48},
						99D0714={49},
						07D1418={50},
						03D0714={51},
						07T2330={52},
						99D30OV={53},
						04D2330={54},
						07T30OV={55},
						06T0714={56},
						08D1823={57},
						04T30OV={58},
						06D1418={59},
						07D0714={60},
						01D2330={61},
						02D1418={62},
						04D1418={63},
						01T1418={64},
						03T1823={65},
						08D1418={66},
						01D1418={67},
						04T1823={68},
						10T1418={69},
						01T2330={70},
						05D0714={71},
						07T1823={72},
						04T2330={73},
						99D1823={74},
						02D0714={75},
						10T0714={76},
						04D0714={77},
						08T30OV={78},
						99D0000={79},
						04T1418={80},
						02T1418={81},
						03T30OV={82},
						08T1418={83},
						07D1823={84},
						99T2330={85},
						99T0000={86},
						04T0714={87},
						09T30OV={88},
						01T0714={89},
						10T1823={90},
						05T30OV={91},
						05T2330={92},
						05D2330={93}
					where 
						stud_id='{1}'
					"""
		accessor.cur_close()
		cmd = template.format(
			const.TBL_KJDB_STUD_SCORE, 
			ss['stud_id'],#1
			ss['09T1823'],#2
			ss['07D2330'],#3
			ss['07T1418'],#4
			ss['05T1418'],#5
			ss['06T1418'],#6
			ss['99D1418'],#7
			ss['06D2330'],#8
			ss['99T1418'],#9
			ss['08T1823'],#10
			ss['02T2330'],#11
			ss['02D2330'],#12
			ss['10D1418'],#13
			ss['09T0714'],#14
			ss['03D1418'],#15
			ss['99T1823'],#16
			ss['10T30OV'],#17
			ss['05T1823'],#18
			ss['09D0714'],#19
			ss['09T2330'],#20
			ss['01D0714'],#21
			ss['10D2330'],#22
			ss['05D1418'],#23
			ss['05D1823'],#24
			ss['10D0714'],#25
			ss['03T2330'],#26
			ss['08D0714'],#27
			ss['06T2330'],#28
			ss['03T1418'],#29
			ss['99T0714'],#30
			ss['08T0714'],#31
			ss['05T0714'],#32
			ss['99T30OV'],#33
			ss['02T1823'],#34
			ss['01T1823'],#35
			ss['07T0714'],#36
			ss['02T0714'],#37
			ss['09D1418'],#38
			ss['06T30OV'],#39
			ss['08T2330'],#40
			ss['09D1823'],#41
			ss['99D2330'],#42
			ss['10T2330'],#43
			ss['06T1823'],#44
			ss['09T1418'],#45
			ss['03T0714'],#46
			ss['03D2330'],#47
			ss['06D0714'],#48
			ss['99D0714'],#49
			ss['07D1418'],#50
			ss['03D0714'],#51
			ss['07T2330'],#52
			ss['99D30OV'],#53
			ss['04D2330'],#54
			ss['07T30OV'],#55
			ss['06T0714'],#56
			ss['08D1823'],#57
			ss['04T30OV'],#58
			ss['06D1418'],#59
			ss['07D0714'],#60
			ss['01D2330'],#61
			ss['02D1418'],#62
			ss['04D1418'],#63
			ss['01T1418'],#64
			ss['03T1823'],#65
			ss['08D1418'],#66
			ss['01D1418'],#67
			ss['04T1823'],#68
			ss['10T1418'],#69
			ss['01T2330'],#70
			ss['05D0714'],#71
			ss['07T1823'],#72
			ss['04T2330'],#73
			ss['99D1823'],#74
			ss['02D0714'],#75
			ss['10T0714'],#76
			ss['04D0714'],#77
			ss['08T30OV'],#78
			ss['99D0000'],#79
			ss['04T1418'],#80
			ss['02T1418'],#81
			ss['03T30OV'],#82
			ss['08T1418'],#83
			ss['07D1823'],#84
			ss['99T2330'],#85
			ss['99T0000'],#86
			ss['04T0714'],#87
			ss['09T30OV'],#88
			ss['01T0714'],#89
			ss['10T1823'],#90
			ss['05T30OV'],#91
			ss['05T2330'],#92
			ss['05D2330'],#93

			)
					 
		accessor.execute(cmd)
		accessor.commit()
		accessor.cur_close()
	except Exception as e:
		print(f'{os.path.basename(__file__)}->{inspect.currentframe().f_code.co_name} {e}')		



def upsert_to_file(accessor, ss):

	try:
		template = """
			select 
				count(*) 
			from 
				{0}
			where	
				stud_id ='{1}' 
			"""
		cmd = template.format(
			const.TBL_KJDB_STUD_SCORE,
			ss['stud_id']
			)
		accessor.execute(cmd)

		count =0
		for c in accessor.cur.fetchall():
			count = int(c[0])
			break	  
		if 0 ==  count:  
			template = """
					insert into {0} 
					( 
						stud_id,
						09T1823,
						07D2330,
						07T1418,
						05T1418,
						06T1418,
						99D1418,
						06D2330,
						99T1418,
						08T1823,
						02T2330,
						02D2330,
						10D1418,
						09T0714,
						03D1418,
						99T1823,
						10T30OV,
						05T1823,
						09D0714,
						09T2330,
						01D0714,
						10D2330,
						05D1418,
						05D1823,
						10D0714,
						03T2330,
						08D0714,
						06T2330,
						03T1418,
						99T0714,
						08T0714,
						05T0714,
						99T30OV,
						02T1823,
						01T1823,
						07T0714,
						02T0714,
						09D1418,
						06T30OV,
						08T2330,
						09D1823,
						99D2330,
						10T2330,
						06T1823,
						09T1418,
						03T0714,
						03D2330,
						06D0714,
						99D0714,
						07D1418,
						03D0714,
						07T2330,
						99D30OV,
						04D2330,
						07T30OV,
						06T0714,
						08D1823,
						04T30OV,
						06D1418,
						07D0714,
						01D2330,
						02D1418,
						04D1418,
						01T1418,
						03T1823,
						08D1418,
						01D1418,
						04T1823,
						10T1418,
						01T2330,
						05D0714,
						07T1823,
						04T2330,
						99D1823,
						02D0714,
						10T0714,
						04D0714,
						08T30OV,
						99D0000,
						04T1418,
						02T1418,
						03T30OV,
						08T1418,
						07D1823,
						99T2330,
						99T0000,
						04T0714,
						09T30OV,
						01T0714,
						10T1823,
						05T30OV,
						05T2330,
						05D2330


					) values (
						'{1}',  {2} , {3} ,   {4} ,  {5} ,  {6} ,  {7} ,  {8} ,  {9} , {10} ,
						{11} , {12} , {13} , {14} , {15} , {16} , {17} , {18} , {19} , {20} ,
						{21} , {22} , {23} , {24} , {25} , {26} , {27} , {28} , {29} , {30} ,
						{31} , {32} , {33} , {34} , {35} , {36} , {37} , {38} , {39} , {40} ,
						{41} , {42} , {43} , {44} , {45} , {46} , {47} , {48} , {49} , {50} ,
						{51} , {52} , {53} , {54} , {55} , {56} , {57} , {58} , {59} , {60} ,
						{61} , {62} , {63} , {24} , {65} , {66} , {67} , {68} , {69} , {60} ,
						{71} , {72} , {73} , {24} , {75} , {76} , {77} , {78} , {79} , {80} ,
						{81} , {82} , {83} , {24} , {85} , {86} , {87} , {88} , {89} , {90} ,
						{91} , {92} , {93}
					)
					"""
		else:
			template = """
					update {0} 
					set					
						09T1823={2},
						07D2330={3},
						07T1418={4},
						05T1418={5},
						06T1418={6},
						99D1418={7},
						06D2330={8},
						99T1418={9},
						08T1823={10},
						02T2330={11},
						02D2330={12},
						10D1418={13},
						09T0714={14},
						03D1418={15},
						99T1823={16},
						10T30OV={17},
						05T1823={18},
						09D0714={19},
						09T2330={20},
						01D0714={21},
						10D2330={22},
						05D1418={23},
						05D1823={24},
						10D0714={25},
						03T2330={26},
						08D0714={27},
						06T2330={28},
						03T1418={29},
						99T0714={30},
						08T0714={31},
						05T0714={32},
						99T30OV={33},
						02T1823={34},
						01T1823={35},
						07T0714={36},
						02T0714={37},
						09D1418={38},
						06T30OV={39},
						08T2330={40},
						09D1823={41},
						99D2330={42},
						10T2330={43},
						06T1823={44},
						09T1418={45},
						03T0714={46},
						03D2330={47},
						06D0714={48},
						99D0714={49},
						07D1418={50},
						03D0714={51},
						07T2330={52},
						99D30OV={53},
						04D2330={54},
						07T30OV={55},
						06T0714={56},
						08D1823={57},
						04T30OV={58},
						06D1418={59},
						07D0714={60},
						01D2330={61},
						02D1418={62},
						04D1418={63},
						01T1418={64},
						03T1823={65},
						08D1418={66},
						01D1418={67},
						04T1823={68},
						10T1418={69},
						01T2330={70},
						05D0714={71},
						07T1823={72},
						04T2330={73},
						99D1823={74},
						02D0714={75},
						10T0714={76},
						04D0714={77},
						08T30OV={78},
						99D0000={79},
						04T1418={80},
						02T1418={81},
						03T30OV={82},
						08T1418={83},
						07D1823={84},
						99T2330={85},
						99T0000={86},
						04T0714={87},
						09T30OV={88},
						01T0714={89},
						10T1823={90},
						05T30OV={91},
						05T2330={92},
						05D2330={93}
					where 
						stud_id='{1}'
					"""
		accessor.cur_close()
		cmd = template.format(
			const.TBL_KJDB_STUD_SCORE, 
			ss['stud_id'],#1
			ss['09T1823'],#2
			ss['07D2330'],#3
			ss['07T1418'],#4
			ss['05T1418'],#5
			ss['06T1418'],#6
			ss['99D1418'],#7
			ss['06D2330'],#8
			ss['99T1418'],#9
			ss['08T1823'],#10
			ss['02T2330'],#11
			ss['02D2330'],#12
			ss['10D1418'],#13
			ss['09T0714'],#14
			ss['03D1418'],#15
			ss['99T1823'],#16
			ss['10T30OV'],#17
			ss['05T1823'],#18
			ss['09D0714'],#19
			ss['09T2330'],#20
			ss['01D0714'],#21
			ss['10D2330'],#22
			ss['05D1418'],#23
			ss['05D1823'],#24
			ss['10D0714'],#25
			ss['03T2330'],#26
			ss['08D0714'],#27
			ss['06T2330'],#28
			ss['03T1418'],#29
			ss['99T0714'],#30
			ss['08T0714'],#31
			ss['05T0714'],#32
			ss['99T30OV'],#33
			ss['02T1823'],#34
			ss['01T1823'],#35
			ss['07T0714'],#36
			ss['02T0714'],#37
			ss['09D1418'],#38
			ss['06T30OV'],#39
			ss['08T2330'],#40
			ss['09D1823'],#41
			ss['99D2330'],#42
			ss['10T2330'],#43
			ss['06T1823'],#44
			ss['09T1418'],#45
			ss['03T0714'],#46
			ss['03D2330'],#47
			ss['06D0714'],#48
			ss['99D0714'],#49
			ss['07D1418'],#50
			ss['03D0714'],#51
			ss['07T2330'],#52
			ss['99D30OV'],#53
			ss['04D2330'],#54
			ss['07T30OV'],#55
			ss['06T0714'],#56
			ss['08D1823'],#57
			ss['04T30OV'],#58
			ss['06D1418'],#59
			ss['07D0714'],#60
			ss['01D2330'],#61
			ss['02D1418'],#62
			ss['04D1418'],#63
			ss['01T1418'],#64
			ss['03T1823'],#65
			ss['08D1418'],#66
			ss['01D1418'],#67
			ss['04T1823'],#68
			ss['10T1418'],#69
			ss['01T2330'],#70
			ss['05D0714'],#71
			ss['07T1823'],#72
			ss['04T2330'],#73
			ss['99D1823'],#74
			ss['02D0714'],#75
			ss['10T0714'],#76
			ss['04D0714'],#77
			ss['08T30OV'],#78
			ss['99D0000'],#79
			ss['04T1418'],#80
			ss['02T1418'],#81
			ss['03T30OV'],#82
			ss['08T1418'],#83
			ss['07D1823'],#84
			ss['99T2330'],#85
			ss['99T0000'],#86
			ss['04T0714'],#87
			ss['09T30OV'],#88
			ss['01T0714'],#89
			ss['10T1823'],#90
			ss['05T30OV'],#91
			ss['05T2330'],#92
			ss['05D2330'],#93

			)
		cmd = cmd.replace("\n", '')		
		cmd = cmd.replace( '\t' , ' ' )		 
		with open(r"c:\temp\suid.txt", 'a') as f:
			f.write(cmd+";\n")

	except Exception as e:
		print(f'{os.path.basename(__file__)}->{inspect.currentframe().f_code.co_name} {e}')		