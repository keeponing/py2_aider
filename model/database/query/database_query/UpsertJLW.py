# 主牡馬スコア
import os
import inspect

import model.conf.KJraConst as const


def upsert(accessor, ss):

	try:
		template = """
			select 
				count(*) 
			from 
				{0}
			where	
				sire_id = '{1}' 
				and
				mare_id = '{2}'
			"""
		cmd = template.format(
			const.TBL_KJDB_LA_WIN_COUNT,
			ss['sire_id'],
			ss['mare_id']
			)
		accessor.execute(cmd)

		count =0
		for c in accessor.cur.fetchall():
			count = int(c[0])
			break	  
		if 0 ==  count:  
			template = """
					insert into {0} 
					( 
						sire_id,
						mare_id,
						09T1823,
						07D2330,
						07T1418,
						05T1418,
						06T1418,
						99D1418,
						06D2330,
						99T1418,
						08T1823,
						02T2330,
						02D2330,
						10D1418,
						09T0714,
						03D1418,
						99T1823,
						10T30OV,
						05T1823,
						09D0714,
						09T2330,
						01D0714,
						10D2330,
						05D1418,
						05D1823,
						10D0714,
						03T2330,
						08D0714,
						06T2330,
						03T1418,
						99T0714,
						08T0714,
						05T0714,
						99T30OV,
						02T1823,
						01T1823,
						07T0714,
						02T0714,
						09D1418,
						06T30OV,
						08T2330,
						09D1823,
						99D2330,
						10T2330,
						06T1823,
						09T1418,
						03T0714,
						03D2330,
						06D0714,
						99D0714,
						07D1418,
						03D0714,
						07T2330,
						99D30OV,
						04D2330,
						07T30OV,
						06T0714,
						08D1823,
						04T30OV,
						06D1418,
						07D0714,
						01D2330,
						02D1418,
						04D1418,
						01T1418,
						03T1823,
						08D1418,
						01D1418,
						04T1823,
						10T1418,
						01T2330,
						05D0714,
						07T1823,
						04T2330,
						99D1823,
						02D0714,
						10T0714,
						04D0714,
						08T30OV,
						99D0000,
						04T1418,
						02T1418,
						03T30OV,
						08T1418,
						07D1823,
						99T2330,
						99T0000,
						04T0714,
						09T30OV,
						01T0714,
						10T1823,
						05T30OV,
						05T2330,
						05D2330,
						upd
					) values (
						'{1}', '{2}',  {3} ,  {4} ,  {5} ,  {6} ,  {7} ,  {8} ,  {9} , {10} ,
						{11} , {12} , {13} , {14} , {15} , {16} , {17} , {18} , {19} , {20} ,
						{21} , {22} , {23} , {24} , {25} , {26} , {27} , {28} , {29} , {30} ,
						{31} , {32} , {33} , {34} , {35} , {36} , {37} , {38} , {39} , {40} ,
						{41} , {42} , {43} , {44} , {45} , {46} , {47} , {48} , {49} , {50} ,
						{51} , {52} , {53} , {54} , {55} , {56} , {57} , {58} , {59} , {60} ,
						{61} , {62} , {63} , {24} , {65} , {66} , {67} , {68} , {69} , {60} ,
						{71} , {72} , {73} , {24} , {75} , {76} , {77} , {78} , {79} , {80} ,
						{81} , {82} , {83} , {24} , {85} , {86} , {87} , {88} , {89} , {90} ,
						{91} , {92} , {93} , {94} , {95} 
					)
					"""
		else:
			template = """
					update {0} 
					set					
						09T1823={3},
						07D2330={4},
						07T1418={5},
						05T1418={6},
						06T1418={7},
						99D1418={8},
						06D2330={9},
						99T1418={10},
						08T1823={11},
						02T2330={12},
						02D2330={13},
						10D1418={14},
						09T0714={15},
						03D1418={16},
						99T1823={17},
						10T30OV={18},
						05T1823={19},
						09D0714={20},
						09T2330={21},
						01D0714={22},
						10D2330={23},
						05D1418={24},
						05D1823={25},
						10D0714={26},
						03T2330={27},
						08D0714={28},
						06T2330={29},
						03T1418={30},
						99T0714={31},
						08T0714={32},
						05T0714={33},
						99T30OV={34},
						02T1823={35},
						01T1823={36},
						07T0714={37},
						02T0714={38},
						09D1418={39},
						06T30OV={40},
						08T2330={41},
						09D1823={42},
						99D2330={43},
						10T2330={44},
						06T1823={45},
						09T1418={46},
						03T0714={47},
						03D2330={48},
						06D0714={49},
						99D0714={50},
						07D1418={51},
						03D0714={52},
						07T2330={53},
						99D30OV={54},
						04D2330={55},
						07T30OV={56},
						06T0714={57},
						08D1823={58},
						04T30OV={59},
						06D1418={60},
						07D0714={61},
						01D2330={62},
						02D1418={63},
						04D1418={64},
						01T1418={65},
						03T1823={66},
						08D1418={67},
						01D1418={68},
						04T1823={69},
						10T1418={70},
						01T2330={71},
						05D0714={72},
						07T1823={73},
						04T2330={74},
						99D1823={75},
						02D0714={76},
						10T0714={77},
						04D0714={78},
						08T30OV={79},
						99D0000={80},
						04T1418={81},
						02T1418={82},
						03T30OV={83},
						08T1418={84},
						07D1823={85},
						99T2330={86},
						99T0000={87},
						04T0714={88},
						09T30OV={89},
						01T0714={90},
						10T1823={91},
						05T30OV={92},
						05T2330={93},
						05D2330={94},
						upd = {95}
					where 
						sire_id='{1}'
						and
						mare_id='{2}'
					"""
		accessor.cur_close()
		cmd = template.format(
			const.TBL_KJDB_LA_WIN_COUNT, 
			ss['sire_id'],#1
   			ss['mare_id'],#2
			ss['09T1823'],#3
			ss['07D2330'],#4
			ss['07T1418'],#5
			ss['05T1418'],#6
			ss['06T1418'],#7
			ss['99D1418'],#8
			ss['06D2330'],#9
			ss['99T1418'],#10
			ss['08T1823'],#11
			ss['02T2330'],#12
			ss['02D2330'],#13
			ss['10D1418'],#14
			ss['09T0714'],#15
			ss['03D1418'],#16
			ss['99T1823'],#17
			ss['10T30OV'],#18
			ss['05T1823'],#19
			ss['09D0714'],#20
			ss['09T2330'],#21
			ss['01D0714'],#22
			ss['10D2330'],#23
			ss['05D1418'],#24
			ss['05D1823'],#25
			ss['10D0714'],#26
			ss['03T2330'],#27
			ss['08D0714'],#28
			ss['06T2330'],#29
			ss['03T1418'],#30
			ss['99T0714'],#31
			ss['08T0714'],#32
			ss['05T0714'],#33
			ss['99T30OV'],#34
			ss['02T1823'],#35
			ss['01T1823'],#36
			ss['07T0714'],#37
			ss['02T0714'],#38
			ss['09D1418'],#39
			ss['06T30OV'],#40
			ss['08T2330'],#41
			ss['09D1823'],#42
			ss['99D2330'],#43
			ss['10T2330'],#44
			ss['06T1823'],#45
			ss['09T1418'],#46
			ss['03T0714'],#47
			ss['03D2330'],#48
			ss['06D0714'],#49
			ss['99D0714'],#50
			ss['07D1418'],#51
			ss['03D0714'],#52
			ss['07T2330'],#53
			ss['99D30OV'],#54
			ss['04D2330'],#55
			ss['07T30OV'],#56
			ss['06T0714'],#57
			ss['08D1823'],#58
			ss['04T30OV'],#59
			ss['06D1418'],#60
			ss['07D0714'],#61
			ss['01D2330'],#62
			ss['02D1418'],#63
			ss['04D1418'],#64
			ss['01T1418'],#65
			ss['03T1823'],#66
			ss['08D1418'],#67
			ss['01D1418'],#68
			ss['04T1823'],#69
			ss['10T1418'],#70
			ss['01T2330'],#71
			ss['05D0714'],#72
			ss['07T1823'],#73
			ss['04T2330'],#74
			ss['99D1823'],#75
			ss['02D0714'],#76
			ss['10T0714'],#77
			ss['04D0714'],#78
			ss['08T30OV'],#79
			ss['99D0000'],#80
			ss['04T1418'],#81
			ss['02T1418'],#82
			ss['03T30OV'],#83
			ss['08T1418'],#84
			ss['07D1823'],#85
			ss['99T2330'],#86
			ss['99T0000'],#87
			ss['04T0714'],#88
			ss['09T30OV'],#89
			ss['01T0714'],#90
			ss['10T1823'],#91
			ss['05T30OV'],#92
			ss['05T2330'],#93
			ss['05D2330'],#94
			ss['upd'],#95
			)
		# cmd = cmd.replace( '\n' , ' ' )
		# cmd = cmd.replace( '\t' , ' ' )						 
		accessor.execute(cmd)
		accessor.commit()
		accessor.cur_close()
	except Exception as e:
		print(f'{os.path.basename(__file__)}->{inspect.currentframe().f_code.co_name} {e}')	


def upsert_to_file(accessor, ss):

	try:
		template = """
			select 
				count(*) 
			from 
				{0}
			where	
				sire_id = '{1}' 
				and
				mare_id = '{2}'
			"""
		cmd = template.format(
			const.TBL_KJDB_LA_WIN_COUNT,
			ss['sire_id'],
			ss['mare_id']
			)
		accessor.execute(cmd)

		count =0
		for c in accessor.cur.fetchall():
			count = int(c[0])
			break	  
		if 0 ==  count:  
			template = """
					insert into {0} 
					( 
						sire_id,
						mare_id,
						09T1823,
						07D2330,
						07T1418,
						05T1418,
						06T1418,
						99D1418,
						06D2330,
						99T1418,
						08T1823,
						02T2330,
						02D2330,
						10D1418,
						09T0714,
						03D1418,
						99T1823,
						10T30OV,
						05T1823,
						09D0714,
						09T2330,
						01D0714,
						10D2330,
						05D1418,
						05D1823,
						10D0714,
						03T2330,
						08D0714,
						06T2330,
						03T1418,
						99T0714,
						08T0714,
						05T0714,
						99T30OV,
						02T1823,
						01T1823,
						07T0714,
						02T0714,
						09D1418,
						06T30OV,
						08T2330,
						09D1823,
						99D2330,
						10T2330,
						06T1823,
						09T1418,
						03T0714,
						03D2330,
						06D0714,
						99D0714,
						07D1418,
						03D0714,
						07T2330,
						99D30OV,
						04D2330,
						07T30OV,
						06T0714,
						08D1823,
						04T30OV,
						06D1418,
						07D0714,
						01D2330,
						02D1418,
						04D1418,
						01T1418,
						03T1823,
						08D1418,
						01D1418,
						04T1823,
						10T1418,
						01T2330,
						05D0714,
						07T1823,
						04T2330,
						99D1823,
						02D0714,
						10T0714,
						04D0714,
						08T30OV,
						99D0000,
						04T1418,
						02T1418,
						03T30OV,
						08T1418,
						07D1823,
						99T2330,
						99T0000,
						04T0714,
						09T30OV,
						01T0714,
						10T1823,
						05T30OV,
						05T2330,
						05D2330,
						upd


					) values (
						'{1}', '{2}',  {3} ,   {4} ,  {5} ,  {6} ,  {7} ,  {8} ,  {9} , {10} ,
						{11} , {12} , {13} , {14} , {15} , {16} , {17} , {18} , {19} , {20} ,
						{21} , {22} , {23} , {24} , {25} , {26} , {27} , {28} , {29} , {30} ,
						{31} , {32} , {33} , {34} , {35} , {36} , {37} , {38} , {39} , {40} ,
						{41} , {42} , {43} , {44} , {45} , {46} , {47} , {48} , {49} , {50} ,
						{51} , {52} , {53} , {54} , {55} , {56} , {57} , {58} , {59} , {60} ,
						{61} , {62} , {63} , {24} , {65} , {66} , {67} , {68} , {69} , {60} ,
						{71} , {72} , {73} , {24} , {75} , {76} , {77} , {78} , {79} , {80} ,
						{81} , {82} , {83} , {24} , {85} , {86} , {87} , {88} , {89} , {90} ,
						{91} , {92} , {93} , {94} , {95} 
					)
					"""
		else:
			template = """
					update {0} 
					set					
						09T1823={3},
						07D2330={4},
						07T1418={5},
						05T1418={6},
						06T1418={7},
						99D1418={8},
						06D2330={9},
						99T1418={10},
						08T1823={11},
						02T2330={12},
						02D2330={13},
						10D1418={14},
						09T0714={15},
						03D1418={16},
						99T1823={17},
						10T30OV={18},
						05T1823={19},
						09D0714={20},
						09T2330={21},
						01D0714={22},
						10D2330={23},
						05D1418={24},
						05D1823={25},
						10D0714={26},
						03T2330={27},
						08D0714={28},
						06T2330={29},
						03T1418={30},
						99T0714={31},
						08T0714={32},
						05T0714={33},
						99T30OV={34},
						02T1823={35},
						01T1823={36},
						07T0714={37},
						02T0714={38},
						09D1418={39},
						06T30OV={40},
						08T2330={41},
						09D1823={42},
						99D2330={43},
						10T2330={44},
						06T1823={45},
						09T1418={46},
						03T0714={47},
						03D2330={48},
						06D0714={49},
						99D0714={50},
						07D1418={51},
						03D0714={52},
						07T2330={53},
						99D30OV={54},
						04D2330={55},
						07T30OV={56},
						06T0714={57},
						08D1823={58},
						04T30OV={59},
						06D1418={60},
						07D0714={61},
						01D2330={62},
						02D1418={63},
						04D1418={64},
						01T1418={65},
						03T1823={66},
						08D1418={67},
						01D1418={68},
						04T1823={69},
						10T1418={70},
						01T2330={71},
						05D0714={72},
						07T1823={73},
						04T2330={74},
						99D1823={75},
						02D0714={76},
						10T0714={77},
						04D0714={78},
						08T30OV={79},
						99D0000={80},
						04T1418={81},
						02T1418={82},
						03T30OV={83},
						08T1418={84},
						07D1823={85},
						99T2330={86},
						99T0000={87},
						04T0714={88},
						09T30OV={89},
						01T0714={90},
						10T1823={91},
						05T30OV={92},
						05T2330={93},
						05D2330={94},
						upd = {95}
					where 
						sire_id='{1}'
						and
						mare_id='{2}'
					"""
		accessor.cur_close()
		cmd = template.format(
			const.TBL_KJDB_LA_WIN_COUNT, 
			ss['sire_id'],#1
   			ss['mare_id'],#2
			ss['09T1823'],#3
			ss['07D2330'],#4
			ss['07T1418'],#5
			ss['05T1418'],#6
			ss['06T1418'],#7
			ss['99D1418'],#8
			ss['06D2330'],#9
			ss['99T1418'],#10
			ss['08T1823'],#11
			ss['02T2330'],#12
			ss['02D2330'],#13
			ss['10D1418'],#14
			ss['09T0714'],#15
			ss['03D1418'],#16
			ss['99T1823'],#17
			ss['10T30OV'],#18
			ss['05T1823'],#19
			ss['09D0714'],#20
			ss['09T2330'],#21
			ss['01D0714'],#22
			ss['10D2330'],#23
			ss['05D1418'],#24
			ss['05D1823'],#25
			ss['10D0714'],#26
			ss['03T2330'],#27
			ss['08D0714'],#28
			ss['06T2330'],#29
			ss['03T1418'],#30
			ss['99T0714'],#31
			ss['08T0714'],#32
			ss['05T0714'],#33
			ss['99T30OV'],#34
			ss['02T1823'],#35
			ss['01T1823'],#36
			ss['07T0714'],#37
			ss['02T0714'],#38
			ss['09D1418'],#39
			ss['06T30OV'],#40
			ss['08T2330'],#41
			ss['09D1823'],#42
			ss['99D2330'],#43
			ss['10T2330'],#44
			ss['06T1823'],#45
			ss['09T1418'],#46
			ss['03T0714'],#47
			ss['03D2330'],#48
			ss['06D0714'],#49
			ss['99D0714'],#50
			ss['07D1418'],#51
			ss['03D0714'],#52
			ss['07T2330'],#53
			ss['99D30OV'],#54
			ss['04D2330'],#55
			ss['07T30OV'],#56
			ss['06T0714'],#57
			ss['08D1823'],#58
			ss['04T30OV'],#59
			ss['06D1418'],#60
			ss['07D0714'],#61
			ss['01D2330'],#62
			ss['02D1418'],#63
			ss['04D1418'],#64
			ss['01T1418'],#65
			ss['03T1823'],#66
			ss['08D1418'],#67
			ss['01D1418'],#68
			ss['04T1823'],#69
			ss['10T1418'],#70
			ss['01T2330'],#71
			ss['05D0714'],#72
			ss['07T1823'],#73
			ss['04T2330'],#74
			ss['99D1823'],#75
			ss['02D0714'],#76
			ss['10T0714'],#77
			ss['04D0714'],#78
			ss['08T30OV'],#79
			ss['99D0000'],#80
			ss['04T1418'],#81
			ss['02T1418'],#82
			ss['03T30OV'],#83
			ss['08T1418'],#84
			ss['07D1823'],#85
			ss['99T2330'],#86
			ss['99T0000'],#87
			ss['04T0714'],#88
			ss['09T30OV'],#89
			ss['01T0714'],#90
			ss['10T1823'],#91
			ss['05T30OV'],#92
			ss['05T2330'],#93
			ss['05D2330'],#94
			ss['upd'],#95
			)
		cmd = cmd.replace("\n", '')		
		cmd = cmd.replace( '\t' , ' ' )		 
		with open(rf"c:\temp\{const.TBL_KJDB_LA_WIN_COUNT}.txt", 'a') as f:
			f.write(cmd+";\n")

	except Exception as e:
		print(f'{os.path.basename(__file__)}->{inspect.currentframe().f_code.co_name} {e}')	