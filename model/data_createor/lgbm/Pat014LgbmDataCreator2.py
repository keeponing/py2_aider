
import inspect
import pandas as pd

import os
import inspect
from model.features.format.concrete.SimpleFormatter import SimpleFormatter
from model.features.format.concrete.LabelConvFormatter import LabelConvFormatter
from model.features.format.FeatureFormatter import FeatureFormatter
from model.database.drivers.driver_factory.QueryFactory import QueryFactory
import model.utility.k_jra_util as util
class Pat014LgbmDataCreator2:

	def __init__(self):
		pass
	def get_category_list(self, full_gate):
		ret = []
		ret.append(f'target')
		for k in range(full_gate):
			l=k+1
			ret.append(f'rr_r_j_id_{l}')
			ret.append(f'rr_r_t_id_{l}')
			ret.append(f'rr_r_horse_no_{l}')
		ret.append(f'rh_cnd_hash256')
		return ret 	
				
	def get_category_list2(self):
		ret = []
		ret.append(f'rr_r_j_id')
		ret.append(f'rr_r_t_id')
		ret.append(f'rr_r_horse_no')
		ret.append(f'rh_cnd_hash256')
		return ret 	
	
	def create(self, df_cache, full_gate, is_train = True):
		ret = None
		try:
	
			formatter = self.prepare(is_train, full_gate)
			series_list= []
			for k in range(len(df_cache)):
				sr_re = df_cache.iloc[k]
				try:
					if(is_train == True):
						formatter['obj_rank'].val = int(sr_re['obj_rank'])
					formatter['rh_cnd_hash256'].val = sr_re['rh_cnd_hash256']
					if(sr_re['target'].isdigit()):
						formatter['target'].val = int(sr_re['target'])
					else:
						formatter['target'].val = 99
					for l in range(full_gate):
						try:
							j=l+1

							# formatter[f'rr_r_vote_{j}'].val = float(sr_re[f'rr_r_vote_{j}'])
							# formatter[f'rr_r_odds_{j}'].val = float(sr_re[f'rr_r_odds_{j}'])
							formatter[f'rr_r_horse_no_{j}'].val = float(sr_re[f'rr_r_horse_no_{j}'])
							formatter[f'rr_r_j_id_{j}'].val = sr_re[f'rr_r_j_id_{j}']
							formatter[f'rr_r_t_id_{j}'].val = sr_re[f'rr_r_t_id_{j}']
							#formatter['rr_r_o_id'].val = sr_re['rr_r_o_id']

							formatter[f'his0_speed_exp_{j}'].val = float(sr_re[f'his0_speed_exp_{j}'])
							formatter[f'his1_speed_exp_{j}'].val = float(sr_re[f'his1_speed_exp_{j}'])
							formatter[f'his2_speed_exp_{j}'].val = float(sr_re[f'his2_speed_exp_{j}'])
							formatter[f'his3_speed_exp_{j}'].val = float(sr_re[f'his3_speed_exp_{j}'])
							formatter[f'bs_win_score_{j}'].val = float(sr_re[f'bs_win_score_{j}'])
							formatter[f'bs_mul_score_{j}'].val = float(sr_re[f'bs_mul_score_{j}'])
							formatter[f'his_sc_l4_p1_{j}'].val = float(sr_re[f'his_sc_l4_p1_{j}'])
							formatter[f'his_sc_l4_p2_{j}'].val = float(sr_re[f'his_sc_l4_p2_{j}'])
							formatter[f'his_sc_l4_p3_{j}'].val = float(sr_re[f'his_sc_l4_p3_{j}'])
							formatter[f'his_sc_l4_p4_{j}'].val = float(sr_re[f'his_sc_l4_p4_{j}'])
							formatter[f'his_l4_p1_{j}'].val = float(sr_re[f'his_l4_p1_{j}'])
							formatter[f'his_l4_p2_{j}'].val = float(sr_re[f'his_l4_p2_{j}'])
							formatter[f'his_l4_p3_{j}'].val = float(sr_re[f'his_l4_p3_{j}'])
							formatter[f'his_l4_p4_{j}'].val = float(sr_re[f'his_l4_p4_{j}'])
							formatter[f'sv_win_ratio_{j}'].val = float(sr_re[f'sv_win_ratio_{j}'])
							formatter[f'sv_mul_ratio_{j}'].val = float(sr_re[f'sv_mul_ratio_{j}'])
	
							formatter[f'sv_burdern_{j}'].val = float(sr_re[f'sv_burdern_{j}'])	
							formatter[f'sv_odds_{j}'].val = float(sr_re[f'sv_odds_{j}'])	
							formatter[f'sv_weight_{j}'].val = float(sr_re[f'sv_weight_{j}'])
							formatter[f'sv_timediff_{j}'].val = float(sr_re[f'sv_timediff_{j}'])
							formatter[f'sv_deviation_{j}'].val = float(sr_re[f'sv_deviation_{j}'])	
							formatter[f'sv_deviation3f_{j}'].val = float(sr_re[f'sv_deviation3f_{j}'])
							formatter[f'sv_win_ratio_{j}'].val = float(sr_re[f'sv_win_ratio_{j}'])	
							formatter[f'sv_mul_ratio_{j}'].val = float(sr_re[f'sv_mul_ratio_{j}'])	
							#formatter[f'sv_avg_distance_{j}'].val = float(sr_re[f'sv_avg_distance_{j}'])
							formatter[f'sv_distance_diff_{j}'].val = float(sr_re[f'sv_distance_diff_{j}'])
							formatter[f'sv_arg_dev_{j}'].val = float(sr_re[f'sv_arg_dev_{j}'])	
							formatter[f'sv_arg_3fd_{j}'].val = float(sr_re[f'sv_arg_3fd_{j}'])	
							formatter[f'sv_deviation3f_{j}'].val = float(sr_re[f'sv_deviation3f_{j}'])	
							formatter[f'sv_straight_dev_{j}'].val = float(sr_re[f'sv_straight_dev_{j}'])
							formatter[f'sv_l_corner_dev_{j}'].val = float(sr_re[f'sv_l_corner_dev_{j}'])
							formatter[f'sv_r_corner_dev_{j}'].val = float(sr_re[f'sv_r_corner_dev_{j}'])
							formatter[f'sv_turf_dev_{j}'].val = float(sr_re[f'sv_turf_dev_{j}'])
							formatter[f'sv_dirt_dev_{j}'].val = float(sr_re[f'sv_dirt_dev_{j}'])
							formatter[f'sv_sire_win_score_{j}'].val = float(sr_re[f'sv_sire_win_score_{j}'])
							formatter[f'sv_sire_mul_score_{j}'].val = float(sr_re[f'sv_sire_mul_score_{j}'])
							formatter[f'sv_tr_score_{j}'].val = float(sr_re[f'sv_tr_score_{j}'])
							formatter[f'sv_jk_score_{j}'].val = float(sr_re[f'sv_jk_score_{j}'])
							formatter[f'sv_speed_exp_{j}'].val = float(sr_re[f'sv_speed_exp_{j}'])
							formatter[f'sv_speed_3f_exp_{j}'].val = float(sr_re[f'sv_speed_3f_exp_{j}'])
							formatter[f'sv_speed_exp_l4_{j}'].val = float(sr_re[f'sv_speed_exp_l4_{j}'])

							# formatter[f'te_09T1823_{j}'].val = float(sr_re[f'te_09T1823_{j}'])
							# formatter[f'te_07D2330_{j}'].val = float(sr_re[f'te_07D2330_{j}'])
							# formatter[f'te_07T1418_{j}'].val = float(sr_re[f'te_07T1418_{j}'])
							# formatter[f'te_05T1418_{j}'].val = float(sr_re[f'te_05T1418_{j}'])
							# formatter[f'te_06T1418_{j}'].val = float(sr_re[f'te_06T1418_{j}'])
							# #formatter[f'te_99D1418_{j}'].val = float(sr_re[f'te_99D1418_{j}'])
							# formatter[f'te_06D2330_{j}'].val = float(sr_re[f'te_06D2330_{j}'])
							# #formatter[f'te_99T1418_{j}'].val = float(sr_re[f'te_99T1418_{j}'])
							# formatter[f'te_08T1823_{j}'].val = float(sr_re[f'te_08T1823_{j}'])
							# formatter[f'te_02T2330_{j}'].val = float(sr_re[f'te_02T2330_{j}'])
							# formatter[f'te_02D2330_{j}'].val = float(sr_re[f'te_02D2330_{j}'])
							# formatter[f'te_10D1418_{j}'].val = float(sr_re[f'te_10D1418_{j}'])
							# formatter[f'te_09T0714_{j}'].val = float(sr_re[f'te_09T0714_{j}'])
							# formatter[f'te_03D1418_{j}'].val = float(sr_re[f'te_03D1418_{j}'])
							# #formatter[f'te_99T1823_{j}'].val = float(sr_re[f'te_99T1823_{j}'])
							# formatter[f'te_10T30OV_{j}'].val = float(sr_re[f'te_10T30OV_{j}'])
							# formatter[f'te_05T1823_{j}'].val = float(sr_re[f'te_05T1823_{j}'])
							# formatter[f'te_09D0714_{j}'].val = float(sr_re[f'te_09D0714_{j}'])
							# formatter[f'te_09T2330_{j}'].val = float(sr_re[f'te_09T2330_{j}'])
							# formatter[f'te_01D0714_{j}'].val = float(sr_re[f'te_01D0714_{j}'])
							# formatter[f'te_10D2330_{j}'].val = float(sr_re[f'te_10D2330_{j}'])
							# formatter[f'te_05D1418_{j}'].val = float(sr_re[f'te_05D1418_{j}'])
							# formatter[f'te_05D1823_{j}'].val = float(sr_re[f'te_05D1823_{j}'])
							# formatter[f'te_10D0714_{j}'].val = float(sr_re[f'te_10D0714_{j}'])
							# formatter[f'te_03T2330_{j}'].val = float(sr_re[f'te_03T2330_{j}'])
							# formatter[f'te_08D0714_{j}'].val = float(sr_re[f'te_08D0714_{j}'])
							# formatter[f'te_06T2330_{j}'].val = float(sr_re[f'te_06T2330_{j}'])
							# formatter[f'te_03T1418_{j}'].val = float(sr_re[f'te_03T1418_{j}'])
							# #formatter[f'te_99T0714_{j}'].val = float(sr_re[f'te_99T0714_{j}'])
							# formatter[f'te_08T0714_{j}'].val = float(sr_re[f'te_08T0714_{j}'])
							# formatter[f'te_05T0714_{j}'].val = float(sr_re[f'te_05T0714_{j}'])
							# #formatter[f'te_99T30OV_{j}'].val = float(sr_re[f'te_99T30OV_{j}'])
							# formatter[f'te_02T1823_{j}'].val = float(sr_re[f'te_02T1823_{j}'])
							# formatter[f'te_01T1823_{j}'].val = float(sr_re[f'te_01T1823_{j}'])
							# formatter[f'te_07T0714_{j}'].val = float(sr_re[f'te_07T0714_{j}'])
							# formatter[f'te_02T0714_{j}'].val = float(sr_re[f'te_02T0714_{j}'])
							# formatter[f'te_09D1418_{j}'].val = float(sr_re[f'te_09D1418_{j}'])
							# formatter[f'te_06T30OV_{j}'].val = float(sr_re[f'te_06T30OV_{j}'])
							# formatter[f'te_08T2330_{j}'].val = float(sr_re[f'te_08T2330_{j}'])
							# formatter[f'te_09D1823_{j}'].val = float(sr_re[f'te_09D1823_{j}'])
							# #formatter[f'te_99D2330_{j}'].val = float(sr_re[f'te_99D2330_{j}'])
							# formatter[f'te_10T2330_{j}'].val = float(sr_re[f'te_10T2330_{j}'])
							# formatter[f'te_06T1823_{j}'].val = float(sr_re[f'te_06T1823_{j}'])
							# formatter[f'te_09T1418_{j}'].val = float(sr_re[f'te_09T1418_{j}'])
							# formatter[f'te_03T0714_{j}'].val = float(sr_re[f'te_03T0714_{j}'])
							# formatter[f'te_03D2330_{j}'].val = float(sr_re[f'te_03D2330_{j}'])
							# formatter[f'te_06D0714_{j}'].val = float(sr_re[f'te_06D0714_{j}'])
							# #formatter[f'te_99D0714_{j}'].val = float(sr_re[f'te_99D0714_{j}'])
							# formatter[f'te_07D1418_{j}'].val = float(sr_re[f'te_07D1418_{j}'])
							# formatter[f'te_03D0714_{j}'].val = float(sr_re[f'te_03D0714_{j}'])
							# formatter[f'te_07T2330_{j}'].val = float(sr_re[f'te_07T2330_{j}'])
							# #formatter[f'te_99D30OV_{j}'].val = float(sr_re[f'te_99D30OV_{j}'])
							# formatter[f'te_04D2330_{j}'].val = float(sr_re[f'te_04D2330_{j}'])
							# formatter[f'te_07T30OV_{j}'].val = float(sr_re[f'te_07T30OV_{j}'])
							# formatter[f'te_06T0714_{j}'].val = float(sr_re[f'te_06T0714_{j}'])
							# formatter[f'te_08D1823_{j}'].val = float(sr_re[f'te_08D1823_{j}'])
							# formatter[f'te_04T30OV_{j}'].val = float(sr_re[f'te_04T30OV_{j}'])
							# formatter[f'te_06D1418_{j}'].val = float(sr_re[f'te_06D1418_{j}'])
							# formatter[f'te_07D0714_{j}'].val = float(sr_re[f'te_07D0714_{j}'])
							# formatter[f'te_01D2330_{j}'].val = float(sr_re[f'te_01D2330_{j}'])
							# formatter[f'te_02D1418_{j}'].val = float(sr_re[f'te_02D1418_{j}'])
							# formatter[f'te_04D1418_{j}'].val = float(sr_re[f'te_04D1418_{j}'])
							# formatter[f'te_01T1418_{j}'].val = float(sr_re[f'te_01T1418_{j}'])
							# formatter[f'te_03T1823_{j}'].val = float(sr_re[f'te_03T1823_{j}'])
							# formatter[f'te_08D1418_{j}'].val = float(sr_re[f'te_08D1418_{j}'])
							# formatter[f'te_01D1418_{j}'].val = float(sr_re[f'te_01D1418_{j}'])
							# formatter[f'te_04T1823_{j}'].val = float(sr_re[f'te_04T1823_{j}'])
							# formatter[f'te_10T1418_{j}'].val = float(sr_re[f'te_10T1418_{j}'])
							# formatter[f'te_01T2330_{j}'].val = float(sr_re[f'te_01T2330_{j}'])
							# formatter[f'te_05D0714_{j}'].val = float(sr_re[f'te_05D0714_{j}'])
							# formatter[f'te_07T1823_{j}'].val = float(sr_re[f'te_07T1823_{j}'])
							# formatter[f'te_04T2330_{j}'].val = float(sr_re[f'te_04T2330_{j}'])
							# #formatter[f'te_99D1823_{j}'].val = float(sr_re[f'te_99D1823_{j}'])
							# formatter[f'te_02D0714_{j}'].val = float(sr_re[f'te_02D0714_{j}'])
							# formatter[f'te_10T0714_{j}'].val = float(sr_re[f'te_10T0714_{j}'])
							# formatter[f'te_04D0714_{j}'].val = float(sr_re[f'te_04D0714_{j}'])
							# formatter[f'te_08T30OV_{j}'].val = float(sr_re[f'te_08T30OV_{j}'])
							# formatter[f'te_04T1418_{j}'].val = float(sr_re[f'te_04T1418_{j}'])
							# formatter[f'te_02T1418_{j}'].val = float(sr_re[f'te_02T1418_{j}'])
							# formatter[f'te_03T30OV_{j}'].val = float(sr_re[f'te_03T30OV_{j}'])
							# formatter[f'te_08T1418_{j}'].val = float(sr_re[f'te_08T1418_{j}'])
							# formatter[f'te_07D1823_{j}'].val = float(sr_re[f'te_07D1823_{j}'])
							# #formatter[f'te_99T2330_{j}'].val = float(sr_re[f'te_99T2330_{j}'])
							# formatter[f'te_04T0714_{j}'].val = float(sr_re[f'te_04T0714_{j}'])
							# formatter[f'te_09T30OV_{j}'].val = float(sr_re[f'te_09T30OV_{j}'])
							# formatter[f'te_01T0714_{j}'].val = float(sr_re[f'te_01T0714_{j}'])
							# formatter[f'te_10T1823_{j}'].val = float(sr_re[f'te_10T1823_{j}'])
							# formatter[f'te_05T30OV_{j}'].val = float(sr_re[f'te_05T30OV_{j}'])
							# formatter[f'te_05T2330_{j}'].val = float(sr_re[f'te_05T2330_{j}'])
							# formatter[f'te_05D2330_{j}'].val = float(sr_re[f'te_05D2330_{j}'])
					
						except Exception as e:
							print(sr_re['ph_id'],sr_re['rr_r_horse_id_1'])
							print(f'{os.path.basename(__file__)}->{inspect.currentframe().f_code.co_name} {e}')
						finally:
							pass
					series_list.append(formatter.doit())		

				except Exception as e:
					print(sr_re['ph_id'],sr_re['rr_r_horse_id_1'])
					print(f'{os.path.basename(__file__)}->{inspect.currentframe().f_code.co_name} {e}')
				formatter.clear_val()
			ret = pd.DataFrame.from_records(series_list)

		except Exception as e:
			print(f'{os.path.basename(__file__)}->{inspect.currentframe().f_code.co_name} {e}')
		return ret
		
	def prepare(self, is_train, full_gate):
		t_id_categories, j_id_categories, o_id_categories, place_id_list, race_hash256_list  = QueryFactory().get_categories()
		formatter = FeatureFormatter()
		if(is_train == True):
			formatter['obj_rank'] = SimpleFormatter('obj_rank')
		formatter['rh_cnd_hash256']= LabelConvFormatter('rh_cnd_hash256', race_hash256_list)
		formatter[f'target'] = SimpleFormatter(f'target')
		for i in range(full_gate):
			j=i+1
		
			# formatter[f'rr_r_vote_{j}'] = SimpleFormatter(f'rr_r_vote_{j}')
			# formatter[f'rr_r_odds_{j}'] = SimpleFormatter(f'rr_r_odds_{j}')
			formatter[f'rr_r_t_id_{j}'] = LabelConvFormatter(f'rr_r_t_id_{j}', t_id_categories)
			formatter[f'rr_r_j_id_{j}'] = LabelConvFormatter(f'rr_r_j_id_{j}', j_id_categories)
			formatter[f'rr_r_horse_no_{j}'] = SimpleFormatter(f'rr_r_horse_no_{j}')
			#formatter['rr_r_o_id'] = LabelConvFormatter('rr_r_o_id', o_id_categories)
			formatter[f'his0_speed_exp_{j}'] = SimpleFormatter(f'his0_speed_exp_{j}')
			formatter[f'his1_speed_exp_{j}'] = SimpleFormatter(f'his1_speed_exp_{j}')
			formatter[f'his2_speed_exp_{j}'] = SimpleFormatter(f'his2_speed_exp_{j}')
			formatter[f'his3_speed_exp_{j}'] = SimpleFormatter(f'his3_speed_exp_{j}')
			formatter[f'bs_win_score_{j}'] = SimpleFormatter(f'bs_win_score_{j}') 
			formatter[f'bs_mul_score_{j}'] = SimpleFormatter(f'bs_mul_score_{j}')
			formatter[f'his_sc_l4_p1_{j}'] = SimpleFormatter(f'his_sc_l4_p1_{j}')
			formatter[f'his_sc_l4_p2_{j}'] = SimpleFormatter(f'his_sc_l4_p2_{j}')
			formatter[f'his_sc_l4_p3_{j}'] = SimpleFormatter(f'his_sc_l4_p3_{j}')
			formatter[f'his_sc_l4_p4_{j}'] = SimpleFormatter(f'his_sc_l4_p4_{j}')
			formatter[f'his_l4_p1_{j}'] = SimpleFormatter(f'his_l4_p1_{j}')
			formatter[f'his_l4_p2_{j}'] = SimpleFormatter(f'his_l4_p2_{j}')
			formatter[f'his_l4_p3_{j}'] = SimpleFormatter(f'his_l4_p3_{j}')
			formatter[f'his_l4_p4_{j}'] = SimpleFormatter(f'his_l4_p4_{j}')

			formatter[f'sv_win_ratio_{j}'] = SimpleFormatter(f'sv_win_ratio_{j}')
			formatter[f'sv_mul_ratio_{j}'] = SimpleFormatter(f'sv_mul_ratio_{j}')
			formatter[f'sv_burdern_{j}'] = SimpleFormatter(f'sv_burdern_{j}')	

			formatter[f'sv_odds_{j}'] = SimpleFormatter(f'sv_odds_{j}')		
			formatter[f'sv_weight_{j}'] = SimpleFormatter(f'sv_weight_{j}')	
			formatter[f'sv_timediff_{j}'] = SimpleFormatter(f'sv_timediff_{j}')	
			formatter[f'sv_deviation_{j}'] = SimpleFormatter(f'sv_deviation_{j}')	
			formatter[f'sv_deviation3f_{j}'] = SimpleFormatter(f'sv_deviation3f_{j}')	
			formatter[f'sv_win_ratio_{j}'] = SimpleFormatter(f'sv_win_ratio_{j}')	
			formatter[f'sv_mul_ratio_{j}'] = SimpleFormatter(f'sv_mul_ratio_{j}')	
			#formatter[f'sv_avg_distance_{j}'] = SimpleFormatter(f'sv_avg_distance_{j}')	
			formatter[f'sv_distance_diff_{j}'] = SimpleFormatter(f'sv_distance_diff_{j}')	
			formatter[f'sv_arg_dev_{j}'] = SimpleFormatter(f'sv_arg_dev_{j}')	
			formatter[f'sv_arg_3fd_{j}'] = SimpleFormatter(f'sv_arg_3fd_{j}')	
			formatter[f'sv_deviation3f_{j}'] = SimpleFormatter(f'sv_deviation3f_{j}')	
			formatter[f'sv_straight_dev_{j}'] = SimpleFormatter(f'sv_straight_dev_{j}')
			formatter[f'sv_l_corner_dev_{j}'] = SimpleFormatter(f'sv_l_corner_dev_{j}')	
			formatter[f'sv_r_corner_dev_{j}'] = SimpleFormatter(f'sv_r_corner_dev_{j}')
			formatter[f'sv_turf_dev_{j}'] = SimpleFormatter(f'sv_turf_dev_{j}')
			formatter[f'sv_dirt_dev_{j}'] = SimpleFormatter(f'sv_dirt_dev_{j}')
			formatter[f'sv_sire_win_score_{j}'] = SimpleFormatter(f'sv_sire_win_score_{j}')
			formatter[f'sv_sire_mul_score_{j}'] = SimpleFormatter(f'sv_sire_mul_score_{j}')
			formatter[f'sv_tr_score_{j}'] = SimpleFormatter(f'sv_tr_score_{j}')
			formatter[f'sv_jk_score_{j}'] = SimpleFormatter(f'sv_jk_score_{j}')
			formatter[f'sv_speed_exp_{j}'] = SimpleFormatter(f'sv_speed_exp_{j}')
			formatter[f'sv_speed_3f_exp_{j}'] = SimpleFormatter(f'sv_speed_3f_exp_{j}')
			formatter[f'sv_speed_exp_l4_{j}']= SimpleFormatter(f'sv_speed_exp_l4_{j}')
	

			# formatter[f'te_09T1823_{j}'] = SimpleFormatter(f'te_09T1823_{j}')
			# formatter[f'te_07D2330_{j}'] = SimpleFormatter(f'te_07D2330_{j}')
			# formatter[f'te_07T1418_{j}'] = SimpleFormatter(f'te_07T1418_{j}')
			# formatter[f'te_05T1418_{j}'] = SimpleFormatter(f'te_05T1418_{j}')
			# formatter[f'te_06T1418_{j}'] = SimpleFormatter(f'te_06T1418_{j}')
			# #formatter[f'te_99D1418_{j}'] = SimpleFormatter(f'te_99D1418_{j}')
			# formatter[f'te_06D2330_{j}'] = SimpleFormatter(f'te_06D2330_{j}')
			# #formatter[f'te_99T1418_{j}'] = SimpleFormatter(f'te_99T1418_{j}')
			# formatter[f'te_08T1823_{j}'] = SimpleFormatter(f'te_08T1823_{j}')
			# formatter[f'te_02T2330_{j}'] = SimpleFormatter(f'te_02T2330_{j}')
			# formatter[f'te_02D2330_{j}'] = SimpleFormatter(f'te_02D2330_{j}')
			# formatter[f'te_10D1418_{j}'] = SimpleFormatter(f'te_10D1418_{j}')
			# formatter[f'te_09T0714_{j}'] = SimpleFormatter(f'te_09T0714_{j}')
			# formatter[f'te_03D1418_{j}'] = SimpleFormatter(f'te_03D1418_{j}')
			# #formatter[f'te_99T1823_{j}'] = SimpleFormatter(f'te_99T1823_{j}')
			# formatter[f'te_10T30OV_{j}'] = SimpleFormatter(f'te_10T30OV_{j}')
			# formatter[f'te_05T1823_{j}'] = SimpleFormatter(f'te_05T1823_{j}')
			# formatter[f'te_09D0714_{j}'] = SimpleFormatter(f'te_09D0714_{j}')
			# formatter[f'te_09T2330_{j}'] = SimpleFormatter(f'te_09T2330_{j}')
			# formatter[f'te_01D0714_{j}'] = SimpleFormatter(f'te_01D0714_{j}')
			# formatter[f'te_10D2330_{j}'] = SimpleFormatter(f'te_10D2330_{j}')
			# formatter[f'te_05D1418_{j}'] = SimpleFormatter(f'te_05D1418_{j}')
			# formatter[f'te_05D1823_{j}'] = SimpleFormatter(f'te_05D1823_{j}')
			# formatter[f'te_10D0714_{j}'] = SimpleFormatter(f'te_10D0714_{j}')
			# formatter[f'te_03T2330_{j}'] = SimpleFormatter(f'te_03T2330_{j}')
			# formatter[f'te_08D0714_{j}'] = SimpleFormatter(f'te_08D0714_{j}')
			# formatter[f'te_06T2330_{j}'] = SimpleFormatter(f'te_06T2330_{j}')
			# formatter[f'te_03T1418_{j}'] = SimpleFormatter(f'te_03T1418_{j}')
			# #formatter[f'te_99T0714_{j}'] = SimpleFormatter(f'te_99T0714_{j}')
			# formatter[f'te_08T0714_{j}'] = SimpleFormatter(f'te_08T0714_{j}')
			# formatter[f'te_05T0714_{j}'] = SimpleFormatter(f'te_05T0714_{j}')
			# #formatter[f'te_99T30OV_{j}'] = SimpleFormatter(f'te_99T30OV_{j}')
			# formatter[f'te_02T1823_{j}'] = SimpleFormatter(f'te_02T1823_{j}')
			# formatter[f'te_01T1823_{j}'] = SimpleFormatter(f'te_01T1823_{j}')
			# formatter[f'te_07T0714_{j}'] = SimpleFormatter(f'te_07T0714_{j}')
			# formatter[f'te_02T0714_{j}'] = SimpleFormatter(f'te_02T0714_{j}')
			# formatter[f'te_09D1418_{j}'] = SimpleFormatter(f'te_09D1418_{j}')
			# formatter[f'te_06T30OV_{j}'] = SimpleFormatter(f'te_06T30OV_{j}')
			# formatter[f'te_08T2330_{j}'] = SimpleFormatter(f'te_08T2330_{j}')
			# formatter[f'te_09D1823_{j}'] = SimpleFormatter(f'te_09D1823_{j}')
			# #formatter[f'te_99D2330_{j}'] = SimpleFormatter(f'te_99D2330_{j}')
			# formatter[f'te_10T2330_{j}'] = SimpleFormatter(f'te_10T2330_{j}')
			# formatter[f'te_06T1823_{j}'] = SimpleFormatter(f'te_06T1823_{j}')
			# formatter[f'te_09T1418_{j}'] = SimpleFormatter(f'te_09T1418_{j}')
			# formatter[f'te_03T0714_{j}'] = SimpleFormatter(f'te_03T0714_{j}')
			# formatter[f'te_03D2330_{j}'] = SimpleFormatter(f'te_03D2330_{j}')
			# formatter[f'te_06D0714_{j}'] = SimpleFormatter(f'te_06D0714_{j}')
			# #formatter[f'te_99D0714_{j}'] = SimpleFormatter(f'te_99D0714_{j}')
			# formatter[f'te_07D1418_{j}'] = SimpleFormatter(f'te_07D1418_{j}')
			# formatter[f'te_03D0714_{j}'] = SimpleFormatter(f'te_03D0714_{j}')
			# formatter[f'te_07T2330_{j}'] = SimpleFormatter(f'te_07T2330_{j}')
			# #formatter[f'te_99D30OV_{j}'] = SimpleFormatter(f'te_99D30OV_{j}')
			# formatter[f'te_04D2330_{j}'] = SimpleFormatter(f'te_04D2330_{j}')
			# formatter[f'te_07T30OV_{j}'] = SimpleFormatter(f'te_07T30OV_{j}')
			# formatter[f'te_06T0714_{j}'] = SimpleFormatter(f'te_06T0714_{j}')
			# formatter[f'te_08D1823_{j}'] = SimpleFormatter(f'te_08D1823_{j}')
			# formatter[f'te_04T30OV_{j}'] = SimpleFormatter(f'te_04T30OV_{j}')
			# formatter[f'te_06D1418_{j}'] = SimpleFormatter(f'te_06D1418_{j}')
			# formatter[f'te_07D0714_{j}'] = SimpleFormatter(f'te_07D0714_{j}')
			# formatter[f'te_01D2330_{j}'] = SimpleFormatter(f'te_01D2330_{j}')
			# formatter[f'te_02D1418_{j}'] = SimpleFormatter(f'te_02D1418_{j}')
			# formatter[f'te_04D1418_{j}'] = SimpleFormatter(f'te_04D1418_{j}')
			# formatter[f'te_01T1418_{j}'] = SimpleFormatter(f'te_01T1418_{j}')
			# formatter[f'te_03T1823_{j}'] = SimpleFormatter(f'te_03T1823_{j}')
			# formatter[f'te_08D1418_{j}'] = SimpleFormatter(f'te_08D1418_{j}')
			# formatter[f'te_01D1418_{j}'] = SimpleFormatter(f'te_01D1418_{j}')
			# formatter[f'te_04T1823_{j}'] = SimpleFormatter(f'te_04T1823_{j}')
			# formatter[f'te_10T1418_{j}'] = SimpleFormatter(f'te_10T1418_{j}')
			# formatter[f'te_01T2330_{j}'] = SimpleFormatter(f'te_01T2330_{j}')
			# formatter[f'te_05D0714_{j}'] = SimpleFormatter(f'te_05D0714_{j}')
			# formatter[f'te_07T1823_{j}'] = SimpleFormatter(f'te_07T1823_{j}')
			# formatter[f'te_04T2330_{j}'] = SimpleFormatter(f'te_04T2330_{j}')
			# #formatter[f'te_99D1823_{j}'] = SimpleFormatter(f'te_99D1823_{j}')
			# formatter[f'te_02D0714_{j}'] = SimpleFormatter(f'te_02D0714_{j}')
			# formatter[f'te_10T0714_{j}'] = SimpleFormatter(f'te_10T0714_{j}')
			# formatter[f'te_04D0714_{j}'] = SimpleFormatter(f'te_04D0714_{j}')
			# formatter[f'te_08T30OV_{j}'] = SimpleFormatter(f'te_08T30OV_{j}')
			# formatter[f'te_04T1418_{j}'] = SimpleFormatter(f'te_04T1418_{j}')
			# formatter[f'te_02T1418_{j}'] = SimpleFormatter(f'te_02T1418_{j}')
			# formatter[f'te_03T30OV_{j}'] = SimpleFormatter(f'te_03T30OV_{j}')
			# formatter[f'te_08T1418_{j}'] = SimpleFormatter(f'te_08T1418_{j}')
			# formatter[f'te_07D1823_{j}'] = SimpleFormatter(f'te_07D1823_{j}')
			# #formatter[f'te_99T2330_{j}'] = SimpleFormatter(f'te_99T2330_{j}')
			# formatter[f'te_04T0714_{j}'] = SimpleFormatter(f'te_04T0714_{j}')
			# formatter[f'te_09T30OV_{j}'] = SimpleFormatter(f'te_09T30OV_{j}')
			# formatter[f'te_01T0714_{j}'] = SimpleFormatter(f'te_01T0714_{j}')
			# formatter[f'te_10T1823_{j}'] = SimpleFormatter(f'te_10T1823_{j}')
			# formatter[f'te_05T30OV_{j}'] = SimpleFormatter(f'te_05T30OV_{j}')
			# formatter[f'te_05T2330_{j}'] = SimpleFormatter(f'te_05T2330_{j}')
			# formatter[f'te_05D2330_{j}'] = SimpleFormatter(f'te_05D2330_{j}')
		ret = formatter
		return ret
	
	
	def create2(self, df_cache, is_train = True):
		ret = None
		try:
	
			formatter = self.prepare2(is_train)
			series_list= []
			for k in range(len(df_cache)):
				sr_re = df_cache.iloc[k]
				try:
					if(is_train == True):
						formatter['rr_r_rank'].val = int(sr_re['rr_r_rank'])

					formatter['rh_cnd_hash256'].val = sr_re['rh_cnd_hash256']
					formatter['rr_r_vote'].val = float(sr_re['rr_r_vote'])
					formatter['rr_r_odds'].val = float(sr_re['rr_r_odds'])
					formatter['rr_r_horse_no'].val = float(sr_re['rr_r_horse_no'])
					formatter['rr_r_j_id'].val = sr_re['rr_r_j_id']
					formatter['rr_r_t_id'].val = sr_re['rr_r_t_id']
					#formatter['rr_r_o_id'].val = sr_re['rr_r_o_id']

					formatter['his0_speed_exp'].val = float(sr_re['his0_speed_exp'])
					formatter['his1_speed_exp'].val = float(sr_re['his1_speed_exp'])
					formatter['his2_speed_exp'].val = float(sr_re['his2_speed_exp'])
					formatter['his3_speed_exp'].val = float(sr_re['his3_speed_exp'])
					# formatter['bs_win_score'].val = float(sr_re['bs_win_score'])
					# formatter['bs_mul_score'].val = float(sr_re['bs_mul_score'])
					# formatter['his_sc_l4_p1'].val = float(sr_re['his_sc_l4_p1'])
					# formatter['his_sc_l4_p2'].val = float(sr_re['his_sc_l4_p2'])
					# formatter['his_sc_l4_p3'].val = float(sr_re['his_sc_l4_p3'])
					# formatter['his_sc_l4_p4'].val = float(sr_re['his_sc_l4_p4'])
					# formatter['his_l4_p1'].val = float(sr_re['his_l4_p1'])
					# formatter['his_l4_p2'].val = float(sr_re['his_l4_p2'])
					# formatter['his_l4_p3'].val = float(sr_re['his_l4_p3'])
					# formatter['his_l4_p4'].val = float(sr_re['his_l4_p4'])

					formatter['sv_burdern'].val = float(sr_re['sv_burdern'])	
					#formatter['sv_odds'].val = float(sr_re['sv_odds'])	
					formatter['sv_weight'].val = float(sr_re['sv_weight'])
					#formatter['sv_timedif'].val = float(sr_re['sv_timedif'])
					#formatter['sv_deviation'].val = float(sr_re['sv_deviation'])	
					#formatter['sv_deviation3'].val = float(sr_re['sv_deviation3'])
					formatter['sv_win_score_wa'].val = float(sr_re['sv_win_score_wa'])	
					formatter['sv_mul_score_wa'].val = float(sr_re['sv_mul_score_wa'])	
					#formatter['sv_avg_distance'].val = float(sr_re['sv_avg_distance'])
					#formatter['sv_distance_dif'].val = float(sr_re['sv_distance_dif'])
					formatter['sv_arg_dev'].val = float(sr_re['sv_arg_dev'])	
					formatter['sv_arg_3fd'].val = float(sr_re['sv_arg_3fd'])	
					formatter['sv_straight_dev'].val = float(sr_re['sv_straight_dev'])
					formatter['sv_l_corner_dev'].val = float(sr_re['sv_l_corner_dev'])
					formatter['sv_r_corner_dev'].val = float(sr_re['sv_r_corner_dev'])
					formatter['sv_turf_dev'].val = float(sr_re['sv_turf_dev'])
					formatter['sv_dirt_dev'].val = float(sr_re['sv_dirt_dev'])
					formatter['sv_sire_win_score'].val = float(sr_re['sv_sire_win_score'])
					formatter['sv_sire_mul_score'].val = float(sr_re['sv_sire_mul_score'])
					#formatter['sv_speed_exp'].val = float(sr_re['sv_speed_exp'])
					#formatter['sv_speed_3f_exp'].val = float(sr_re['sv_speed_3f_exp'])
					# formatter['sv_speed_exp_l4'].val = float(sr_re['sv_speed_exp_l4'])

					formatter['te_09T1823'].val = float(sr_re['te_09T1823'])
					formatter['te_07D2330'].val = float(sr_re['te_07D2330'])
					formatter['te_07T1418'].val = float(sr_re['te_07T1418'])
					formatter['te_05T1418'].val = float(sr_re['te_05T1418'])
					formatter['te_06T1418'].val = float(sr_re['te_06T1418'])
					#formatter['te_99D1418'].val = float(sr_re['te_99D1418'])
					formatter['te_06D2330'].val = float(sr_re['te_06D2330'])
					#formatter['te_99T1418'].val = float(sr_re['te_99T1418'])
					formatter['te_08T1823'].val = float(sr_re['te_08T1823'])
					formatter['te_02T2330'].val = float(sr_re['te_02T2330'])
					formatter['te_02D2330'].val = float(sr_re['te_02D2330'])
					formatter['te_10D1418'].val = float(sr_re['te_10D1418'])
					formatter['te_09T0714'].val = float(sr_re['te_09T0714'])
					formatter['te_03D1418'].val = float(sr_re['te_03D1418'])
					#formatter['te_99T1823'].val = float(sr_re['te_99T1823'])
					formatter['te_10T30OV'].val = float(sr_re['te_10T30OV'])
					formatter['te_05T1823'].val = float(sr_re['te_05T1823'])
					formatter['te_09D0714'].val = float(sr_re['te_09D0714'])
					formatter['te_09T2330'].val = float(sr_re['te_09T2330'])
					formatter['te_01D0714'].val = float(sr_re['te_01D0714'])
					formatter['te_10D2330'].val = float(sr_re['te_10D2330'])
					formatter['te_05D1418'].val = float(sr_re['te_05D1418'])
					formatter['te_05D1823'].val = float(sr_re['te_05D1823'])
					formatter['te_10D0714'].val = float(sr_re['te_10D0714'])
					formatter['te_03T2330'].val = float(sr_re['te_03T2330'])
					formatter['te_08D0714'].val = float(sr_re['te_08D0714'])
					formatter['te_06T2330'].val = float(sr_re['te_06T2330'])
					formatter['te_03T1418'].val = float(sr_re['te_03T1418'])
					#formatter['te_99T0714'].val = float(sr_re['te_99T0714'])
					formatter['te_08T0714'].val = float(sr_re['te_08T0714'])
					formatter['te_05T0714'].val = float(sr_re['te_05T0714'])
					#formatter['te_99T30OV'].val = float(sr_re['te_99T30OV'])
					formatter['te_02T1823'].val = float(sr_re['te_02T1823'])
					formatter['te_01T1823'].val = float(sr_re['te_01T1823'])
					formatter['te_07T0714'].val = float(sr_re['te_07T0714'])
					formatter['te_02T0714'].val = float(sr_re['te_02T0714'])
					formatter['te_09D1418'].val = float(sr_re['te_09D1418'])
					formatter['te_06T30OV'].val = float(sr_re['te_06T30OV'])
					formatter['te_08T2330'].val = float(sr_re['te_08T2330'])
					formatter['te_09D1823'].val = float(sr_re['te_09D1823'])
					#formatter['te_99D2330'].val = float(sr_re['te_99D2330'])
					formatter['te_10T2330'].val = float(sr_re['te_10T2330'])
					formatter['te_06T1823'].val = float(sr_re['te_06T1823'])
					formatter['te_09T1418'].val = float(sr_re['te_09T1418'])
					formatter['te_03T0714'].val = float(sr_re['te_03T0714'])
					formatter['te_03D2330'].val = float(sr_re['te_03D2330'])
					formatter['te_06D0714'].val = float(sr_re['te_06D0714'])
					#formatter['te_99D0714'].val = float(sr_re['te_99D0714'])
					formatter['te_07D1418'].val = float(sr_re['te_07D1418'])
					formatter['te_03D0714'].val = float(sr_re['te_03D0714'])
					formatter['te_07T2330'].val = float(sr_re['te_07T2330'])
					#formatter['te_99D30OV'].val = float(sr_re['te_99D30OV'])
					formatter['te_04D2330'].val = float(sr_re['te_04D2330'])
					formatter['te_07T30OV'].val = float(sr_re['te_07T30OV'])
					formatter['te_06T0714'].val = float(sr_re['te_06T0714'])
					formatter['te_08D1823'].val = float(sr_re['te_08D1823'])
					formatter['te_04T30OV'].val = float(sr_re['te_04T30OV'])
					formatter['te_06D1418'].val = float(sr_re['te_06D1418'])
					formatter['te_07D0714'].val = float(sr_re['te_07D0714'])
					formatter['te_01D2330'].val = float(sr_re['te_01D2330'])
					formatter['te_02D1418'].val = float(sr_re['te_02D1418'])
					formatter['te_04D1418'].val = float(sr_re['te_04D1418'])
					formatter['te_01T1418'].val = float(sr_re['te_01T1418'])
					formatter['te_03T1823'].val = float(sr_re['te_03T1823'])
					formatter['te_08D1418'].val = float(sr_re['te_08D1418'])
					formatter['te_01D1418'].val = float(sr_re['te_01D1418'])
					formatter['te_04T1823'].val = float(sr_re['te_04T1823'])
					formatter['te_10T1418'].val = float(sr_re['te_10T1418'])
					formatter['te_01T2330'].val = float(sr_re['te_01T2330'])
					formatter['te_05D0714'].val = float(sr_re['te_05D0714'])
					formatter['te_07T1823'].val = float(sr_re['te_07T1823'])
					formatter['te_04T2330'].val = float(sr_re['te_04T2330'])
					#formatter['te_99D1823'].val = float(sr_re['te_99D1823'])
					formatter['te_02D0714'].val = float(sr_re['te_02D0714'])
					formatter['te_10T0714'].val = float(sr_re['te_10T0714'])
					formatter['te_04D0714'].val = float(sr_re['te_04D0714'])
					formatter['te_08T30OV'].val = float(sr_re['te_08T30OV'])
					formatter['te_04T1418'].val = float(sr_re['te_04T1418'])
					formatter['te_02T1418'].val = float(sr_re['te_02T1418'])
					formatter['te_03T30OV'].val = float(sr_re['te_03T30OV'])
					formatter['te_08T1418'].val = float(sr_re['te_08T1418'])
					formatter['te_07D1823'].val = float(sr_re['te_07D1823'])
					#formatter['te_99T2330'].val = float(sr_re['te_99T2330'])
					formatter['te_04T0714'].val = float(sr_re['te_04T0714'])
					formatter['te_09T30OV'].val = float(sr_re['te_09T30OV'])
					formatter['te_01T0714'].val = float(sr_re['te_01T0714'])
					formatter['te_10T1823'].val = float(sr_re['te_10T1823'])
					formatter['te_05T30OV'].val = float(sr_re['te_05T30OV'])
					formatter['te_05T2330'].val = float(sr_re['te_05T2330'])
					formatter['te_05D2330'].val = float(sr_re['te_05D2330'])
					

					series_list.append(formatter.doit())		

				except Exception as e:
				
					print('{os.path.basename(__file__)}->{inspect.currentframe().f_code.co_name} {e}')
				formatter.clear_val()
			ret = pd.DataFrame.from_records(series_list)
			sr_re = df_cache.iloc[0]
			util.dump_feature(ret, f"{sr_re[f'ph_place']}_{sr_re['rh_track']}_{sr_re['rh_distance']}")
	
		except Exception as e:
			print(f'{os.path.basename(__file__)}->{inspect.currentframe().f_code.co_name} {e}')
		return ret
		
	
	def prepare2(self, is_train):

		t_id_categories, j_id_categories,  o_id_categories, place_id_list, race_hash256_list   =  QueryFactory().get_categories()
		formatter = FeatureFormatter()
		if(is_train == True):
			formatter['rr_r_rank'] = SimpleFormatter('rr_r_rank')
		formatter['rh_cnd_hash256'] = LabelConvFormatter(f'rh_cnd_hash256', race_hash256_list) 
		# formatter[f'target'] = SimpleFormatter(f'target')

		
		formatter[f'rr_r_vote'] = SimpleFormatter(f'rr_r_vote')
		formatter[f'rr_r_odds'] = SimpleFormatter(f'rr_r_odds')
		formatter[f'rr_r_t_id'] = LabelConvFormatter(f'rr_r_t_id', t_id_categories)
		formatter[f'rr_r_j_id'] = LabelConvFormatter(f'rr_r_j_id', j_id_categories)
		formatter[f'rr_r_horse_no'] = SimpleFormatter(f'rr_r_horse_no')
		#formatter['rr_r_o_id'] = LabelConvFormatter('rr_r_o_id', o_id_categories)
		formatter[f'his0_speed_exp'] = SimpleFormatter(f'his0_speed_exp')
		formatter[f'his1_speed_exp'] = SimpleFormatter(f'his1_speed_exp')
		formatter[f'his2_speed_exp'] = SimpleFormatter(f'his2_speed_exp')
		formatter[f'his3_speed_exp'] = SimpleFormatter(f'his3_speed_exp')
		# formatter[f'bs_win_score'] = SimpleFormatter(f'bs_win_score') 
		# formatter[f'bs_mul_score'] = SimpleFormatter(f'bs_mul_score')
		# formatter[f'his_sc_l4_p1'] = SimpleFormatter(f'his_sc_l4_p1')
		# formatter[f'his_sc_l4_p2'] = SimpleFormatter(f'his_sc_l4_p2')
		# formatter[f'his_sc_l4_p3'] = SimpleFormatter(f'his_sc_l4_p3')
		# formatter[f'his_sc_l4_p4'] = SimpleFormatter(f'his_sc_l4_p4')
		# formatter[f'his_l4_p1'] = SimpleFormatter(f'his_l4_p1')
		# formatter[f'his_l4_p2'] = SimpleFormatter(f'his_l4_p2')
		# formatter[f'his_l4_p3'] = SimpleFormatter(f'his_l4_p3')
		# formatter[f'his_l4_p4'] = SimpleFormatter(f'his_l4_p4')

		formatter[f'sv_burdern'] = SimpleFormatter(f'sv_burdern')	

		#formatter[f'sv_odds'] = SimpleFormatter(f'sv_odds')		
		formatter[f'sv_weight'] = SimpleFormatter(f'sv_weight')	
		#formatter[f'sv_timediff'] = SimpleFormatter(f'sv_timediff')	
		#formatter[f'sv_deviation'] = SimpleFormatter(f'sv_deviation')	
		#formatter[f'sv_deviation3f'] = SimpleFormatter(f'sv_deviation3f')	
		formatter[f'sv_win_score_wa'] = SimpleFormatter(f'sv_win_score_wa')	
		formatter[f'sv_mul_score_wa'] = SimpleFormatter(f'sv_mul_score_wa')	
		#formatter[f'sv_avg_distance'] = SimpleFormatter(f'sv_avg_distance')	
		#formatter[f'sv_distance_diff'] = SimpleFormatter(f'sv_distance_diff')	
		formatter[f'sv_arg_dev'] = SimpleFormatter(f'sv_arg_dev')	
		formatter[f'sv_arg_3fd'] = SimpleFormatter(f'sv_arg_3fd')	
		formatter[f'sv_straight_dev'] = SimpleFormatter(f'sv_straight_dev')
		formatter[f'sv_l_corner_dev'] = SimpleFormatter(f'sv_l_corner_dev')	
		formatter[f'sv_r_corner_dev'] = SimpleFormatter(f'sv_r_corner_dev')
		formatter[f'sv_turf_dev'] = SimpleFormatter(f'sv_turf_dev')
		formatter[f'sv_dirt_dev'] = SimpleFormatter(f'sv_dirt_dev')
		formatter[f'sv_sire_win_score'] = SimpleFormatter(f'sv_sire_win_score')
		formatter[f'sv_sire_mul_score'] = SimpleFormatter(f'sv_sire_mul_score')
		#formatter[f'sv_speed_exp'] = SimpleFormatter(f'sv_speed_exp')
		#formatter[f'sv_speed_3f_exp'] = SimpleFormatter(f'sv_speed_3f_exp')
		# formatter[f'sv_speed_exp_l4']= SimpleFormatter(f'sv_speed_exp_l4')


		formatter[f'te_09T1823'] = SimpleFormatter(f'te_09T1823')
		formatter[f'te_07D2330'] = SimpleFormatter(f'te_07D2330')
		formatter[f'te_07T1418'] = SimpleFormatter(f'te_07T1418')
		formatter[f'te_05T1418'] = SimpleFormatter(f'te_05T1418')
		formatter[f'te_06T1418'] = SimpleFormatter(f'te_06T1418')
		#formatter[f'te_99D1418'] = SimpleFormatter(f'te_99D1418')
		formatter[f'te_06D2330'] = SimpleFormatter(f'te_06D2330')
		#formatter[f'te_99T1418'] = SimpleFormatter(f'te_99T1418')
		formatter[f'te_08T1823'] = SimpleFormatter(f'te_08T1823')
		formatter[f'te_02T2330'] = SimpleFormatter(f'te_02T2330')
		formatter[f'te_02D2330'] = SimpleFormatter(f'te_02D2330')
		formatter[f'te_10D1418'] = SimpleFormatter(f'te_10D1418')
		formatter[f'te_09T0714'] = SimpleFormatter(f'te_09T0714')
		formatter[f'te_03D1418'] = SimpleFormatter(f'te_03D1418')
		#formatter[f'te_99T1823'] = SimpleFormatter(f'te_99T1823')
		formatter[f'te_10T30OV'] = SimpleFormatter(f'te_10T30OV')
		formatter[f'te_05T1823'] = SimpleFormatter(f'te_05T1823')
		formatter[f'te_09D0714'] = SimpleFormatter(f'te_09D0714')
		formatter[f'te_09T2330'] = SimpleFormatter(f'te_09T2330')
		formatter[f'te_01D0714'] = SimpleFormatter(f'te_01D0714')
		formatter[f'te_10D2330'] = SimpleFormatter(f'te_10D2330')
		formatter[f'te_05D1418'] = SimpleFormatter(f'te_05D1418')
		formatter[f'te_05D1823'] = SimpleFormatter(f'te_05D1823')
		formatter[f'te_10D0714'] = SimpleFormatter(f'te_10D0714')
		formatter[f'te_03T2330'] = SimpleFormatter(f'te_03T2330')
		formatter[f'te_08D0714'] = SimpleFormatter(f'te_08D0714')
		formatter[f'te_06T2330'] = SimpleFormatter(f'te_06T2330')
		formatter[f'te_03T1418'] = SimpleFormatter(f'te_03T1418')
		#formatter[f'te_99T0714'] = SimpleFormatter(f'te_99T0714')
		formatter[f'te_08T0714'] = SimpleFormatter(f'te_08T0714')
		formatter[f'te_05T0714'] = SimpleFormatter(f'te_05T0714')
		#formatter[f'te_99T30OV'] = SimpleFormatter(f'te_99T30OV')
		formatter[f'te_02T1823'] = SimpleFormatter(f'te_02T1823')
		formatter[f'te_01T1823'] = SimpleFormatter(f'te_01T1823')
		formatter[f'te_07T0714'] = SimpleFormatter(f'te_07T0714')
		formatter[f'te_02T0714'] = SimpleFormatter(f'te_02T0714')
		formatter[f'te_09D1418'] = SimpleFormatter(f'te_09D1418')
		formatter[f'te_06T30OV'] = SimpleFormatter(f'te_06T30OV')
		formatter[f'te_08T2330'] = SimpleFormatter(f'te_08T2330')
		formatter[f'te_09D1823'] = SimpleFormatter(f'te_09D1823')
		#formatter[f'te_99D2330'] = SimpleFormatter(f'te_99D2330')
		formatter[f'te_10T2330'] = SimpleFormatter(f'te_10T2330')
		formatter[f'te_06T1823'] = SimpleFormatter(f'te_06T1823')
		formatter[f'te_09T1418'] = SimpleFormatter(f'te_09T1418')
		formatter[f'te_03T0714'] = SimpleFormatter(f'te_03T0714')
		formatter[f'te_03D2330'] = SimpleFormatter(f'te_03D2330')
		formatter[f'te_06D0714'] = SimpleFormatter(f'te_06D0714')
		#formatter[f'te_99D0714'] = SimpleFormatter(f'te_99D0714')
		formatter[f'te_07D1418'] = SimpleFormatter(f'te_07D1418')
		formatter[f'te_03D0714'] = SimpleFormatter(f'te_03D0714')
		formatter[f'te_07T2330'] = SimpleFormatter(f'te_07T2330')
		#formatter[f'te_99D30OV'] = SimpleFormatter(f'te_99D30OV')
		formatter[f'te_04D2330'] = SimpleFormatter(f'te_04D2330')
		formatter[f'te_07T30OV'] = SimpleFormatter(f'te_07T30OV')
		formatter[f'te_06T0714'] = SimpleFormatter(f'te_06T0714')
		formatter[f'te_08D1823'] = SimpleFormatter(f'te_08D1823')
		formatter[f'te_04T30OV'] = SimpleFormatter(f'te_04T30OV')
		formatter[f'te_06D1418'] = SimpleFormatter(f'te_06D1418')
		formatter[f'te_07D0714'] = SimpleFormatter(f'te_07D0714')
		formatter[f'te_01D2330'] = SimpleFormatter(f'te_01D2330')
		formatter[f'te_02D1418'] = SimpleFormatter(f'te_02D1418')
		formatter[f'te_04D1418'] = SimpleFormatter(f'te_04D1418')
		formatter[f'te_01T1418'] = SimpleFormatter(f'te_01T1418')
		formatter[f'te_03T1823'] = SimpleFormatter(f'te_03T1823')
		formatter[f'te_08D1418'] = SimpleFormatter(f'te_08D1418')
		formatter[f'te_01D1418'] = SimpleFormatter(f'te_01D1418')
		formatter[f'te_04T1823'] = SimpleFormatter(f'te_04T1823')
		formatter[f'te_10T1418'] = SimpleFormatter(f'te_10T1418')
		formatter[f'te_01T2330'] = SimpleFormatter(f'te_01T2330')
		formatter[f'te_05D0714'] = SimpleFormatter(f'te_05D0714')
		formatter[f'te_07T1823'] = SimpleFormatter(f'te_07T1823')
		formatter[f'te_04T2330'] = SimpleFormatter(f'te_04T2330')
		#formatter[f'te_99D1823'] = SimpleFormatter(f'te_99D1823')
		formatter[f'te_02D0714'] = SimpleFormatter(f'te_02D0714')
		formatter[f'te_10T0714'] = SimpleFormatter(f'te_10T0714')
		formatter[f'te_04D0714'] = SimpleFormatter(f'te_04D0714')
		formatter[f'te_08T30OV'] = SimpleFormatter(f'te_08T30OV')
		formatter[f'te_04T1418'] = SimpleFormatter(f'te_04T1418')
		formatter[f'te_02T1418'] = SimpleFormatter(f'te_02T1418')
		formatter[f'te_03T30OV'] = SimpleFormatter(f'te_03T30OV')
		formatter[f'te_08T1418'] = SimpleFormatter(f'te_08T1418')
		formatter[f'te_07D1823'] = SimpleFormatter(f'te_07D1823')
		#formatter[f'te_99T2330'] = SimpleFormatter(f'te_99T2330')
		formatter[f'te_04T0714'] = SimpleFormatter(f'te_04T0714')
		formatter[f'te_09T30OV'] = SimpleFormatter(f'te_09T30OV')
		formatter[f'te_01T0714'] = SimpleFormatter(f'te_01T0714')
		formatter[f'te_10T1823'] = SimpleFormatter(f'te_10T1823')
		formatter[f'te_05T30OV'] = SimpleFormatter(f'te_05T30OV')
		formatter[f'te_05T2330'] = SimpleFormatter(f'te_05T2330')
		formatter[f'te_05D2330'] = SimpleFormatter(f'te_05D2330')
		ret = formatter
		return ret

	